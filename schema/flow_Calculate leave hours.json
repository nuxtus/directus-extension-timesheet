{
  "id": "297e8eff-5896-48a8-a13a-d20f3330cd7d",
  "name": "Calculate leave hours",
  "icon": "avg_pace",
  "color": null,
  "description": "Based on start and end date return total number of hours",
  "trigger": "operation",
  "options": {
    "return": "$last"
  },
  "operation": "b8d75844-5f90-436a-a2dd-36215517b69a",
  "operations": [
    {
      "id": "b8d75844-5f90-436a-a2dd-36215517b69a",
      "name": "Get timesheet settings",
      "key": "get_timesheet_settings",
      "type": "item-read",
      "position_x": 19,
      "position_y": 1,
      "options": {
        "permissions": "$full",
        "collection": "ts_settings"
      },
      "resolve": "bfedc10b-08cb-42de-bdd6-6307a063eae4",
      "reject": null
    },
    {
      "id": "bfedc10b-08cb-42de-bdd6-6307a063eae4",
      "name": "calculate total hours",
      "key": "calculate_total_hours",
      "type": "exec",
      "position_x": 37,
      "position_y": 1,
      "options": {
        "code": "module.exports = async function(data) {\n\tlet startDate = new Date(data.$trigger.start_date);\n    let endDate = new Date(data.$trigger.end_date);\n    let numberOfDays = 0;\n\n    // Loop through each day between start and end dates\n    for (let d = startDate; d <= endDate; d.setDate(d.getDate() + 1)) {\n        // Check if the day is not a Saturday (6) or Sunday (0)\n        if (d.getDay() !== 0 && d.getDay() !== 6) {\n            numberOfDays++;\n        }\n    }\n\treturn numberOfDays*data.get_timesheet_settings[0].leave_hours_per_day;\n}"
      },
      "resolve": null,
      "reject": null
    }
  ]
}